---
id: api
title: API
---

`Vue Testing Library` é‡æ–°å¯¼å‡ºäº† `DOM Testing Library` çš„æ‰€æœ‰å†…å®¹ã€‚

å®ƒè¿˜æš´éœ²äº†è¿™äº›æ–¹æ³•ï¼š

- [`render(Component, options)`](#rendercomponent-options)
  - [Parameters](#parameters)
    - [Component](#component)
    - [Options](#options)
  - [`render` result](#render-result)
    - [`...queries`](#queries)
    - [`container`](#container)
    - [`baseElement`](#baseelement)
    - [`debug`](#debugelement)
    - [`unmount`](#unmount)
    - [`html`](#html)
    - [`emitted`](#emitted)
    - [`rerender`](#rerenderprops)
- [`fireEvent`](#fireevent)
  - [`touch(elem)`](#touchelem)
  - [`update(elem, value)`](#updateelem-value)
- [`cleanup`](#cleanup)

---

## `render(Component, options)`

`render` å‡½æ•°æ˜¯ Vue Testing Library ä¸­æ¸²æŸ“ç»„ä»¶çš„å”¯ä¸€æ–¹æ³•ã€‚

å®ƒæœ€å¤šæ¥æ”¶2ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¸¦æœ‰ä¸€äº›è¾…åŠ©æ–¹æ³•çš„å¯¹è±¡ã€‚

```js
function render(Component, options, callbackFunction) {
  return {
    ...DOMTestingLibraryQueries,
    container,
    baseElement,
    debug(element),
    unmount,
    html,
    emitted,
    rerender(props),
  }
}
```

### å‚æ•°

#### Component

è¦æµ‹è¯•çš„æœ‰æ•ˆVueç»„ä»¶ã€‚

#### Options

ä¸€ä¸ªåŒ…å«é¢å¤–ä¿¡æ¯çš„å¯¹è±¡ï¼Œå°†è¢«ä¼ é€’ç»™ `@vue/test-utils` çš„ [mount](https://vue-test-utils.vuejs.org/api/options.html#mounting-options)ã€‚

æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥æä¾›ä»¥ä¸‹é€‰é¡¹ï¼š

##### `store` (`Object` | `Store`)

ä¸€ä¸ª[Vuex](https://vuex.vuejs.org/)å­˜å‚¨çš„å¯¹è±¡å®šä¹‰ã€‚å¦‚æœæä¾›ä¸€ä¸ª `store` å¯¹è±¡ï¼Œ
`Vue Testing Library` å°†å¯¼å…¥å¹¶é…ç½®ä¸€ä¸ªVuexå­˜å‚¨ã€‚å¦‚æœä¼ é€’äº†ä¸€ä¸ªå®ä¾‹åŒ–çš„Vuexå­˜å‚¨ï¼Œå®ƒå°†è¢«ä½¿ç”¨ã€‚

##### `routes` (`Array` | `VueRouter`)

ä¸€ç»„ç”¨äº[Vue Routerçš„è·¯ç”±](https://router.vuejs.org/)ã€‚å¦‚æœæä¾›äº† `routes`ï¼Œ
è¯¥åº“å°†å¯¼å…¥å¹¶é…ç½®Vue Routerã€‚å¦‚æœä¼ é€’äº†ä¸€ä¸ªå®ä¾‹åŒ–çš„Vue Routerï¼Œå®ƒå°†è¢«ä½¿ç”¨ã€‚

##### `props` (`Object`)

å®ƒå°†ä¸ `propsData` åˆå¹¶ã€‚

##### `container` (`HTMLElement`)

é»˜è®¤æƒ…å†µä¸‹ï¼Œ`Vue Testing Library` ä¼šåˆ›å»ºä¸€ä¸ª `div` å¹¶å°†å…¶é™„åŠ åˆ° `baseElement` ä¸Šã€‚
è¿™æ˜¯ä½ çš„ç»„ä»¶å°†è¢«æ¸²æŸ“çš„åœ°æ–¹ã€‚å¦‚æœä½ é€šè¿‡è¿™ä¸ªé€‰é¡¹æä¾›ä½ è‡ªå·±çš„ `HTMLElement` å®¹å™¨ï¼Œå®ƒå°†ä¸ä¼šè¢«è‡ªåŠ¨é™„åŠ åˆ° `baseElement` ä¸Šã€‚

æ¯”å¦‚è¯´ã€‚å¦‚æœä½ æ­£åœ¨å•å…ƒæµ‹è¯•ä¸€ä¸ª `tablebody` å…ƒç´ ï¼Œå®ƒä¸èƒ½æ˜¯ä¸€ä¸ª `div` çš„å­å…ƒç´ ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥æŒ‡å®šä¸€ä¸ª`table`ä½œä¸ºæ¸²æŸ“`container`ã€‚

```js
const table = document.createElement('table')

const {container} = render(TableBody, {
  props,
  container: document.body.appendChild(table),
})
```

##### `baseElement` (`HTMLElement`)

å¦‚æœæŒ‡å®šäº† `container`ï¼Œåˆ™é»˜è®¤ä¸º `container`çš„å€¼ï¼Œå¦åˆ™é»˜è®¤ä¸º `document.body`ã€‚ 
`baseElement` è¢«ç”¨ä½œæŸ¥è¯¢çš„åŸºç¡€å…ƒç´ ï¼Œä¹Ÿæ˜¯ä½ ä½¿ç”¨ `debug()` æ—¶æ‰“å°çš„å†…å®¹ã€‚

### `render` è¿”å›ç»“æœ

`render` æ–¹æ³•è¿”å›ä¸€ä¸ªæœ‰å‡ ä¸ªå±æ€§çš„å¯¹è±¡ã€‚

#### `...queries`

`render` æœ€é‡è¦çš„ç‰¹ç‚¹æ˜¯ï¼Œ[DOM Testing Library](queries/about.mdx)çš„æŸ¥è¯¢ä¼šè‡ªåŠ¨è¿”å›ï¼Œ
å…¶ç¬¬ä¸€ä¸ªå‚æ•°ç»‘å®šåˆ° `baseElement`ï¼Œé»˜è®¤ä¸º `document.body`ã€‚

æŸ¥çœ‹[æŸ¥è¯¢](queries/about.mdx)çš„å®Œæ•´åˆ—è¡¨ã€‚

```js
const {getByLabelText, queryAllByTestId} = render(Component)
```

#### `container`

æ¸²æŸ“åçš„Vueç»„ä»¶æ‰€åŒ…å«çš„DOMèŠ‚ç‚¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ä¸€ä¸ª `div`ã€‚è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„DOMèŠ‚ç‚¹ï¼Œ
æ‰€ä»¥ä½ å¯ä»¥è°ƒç”¨ `container.querySelector` ç­‰æ¥æ£€æŸ¥å­å…ƒç´ ã€‚

> æç¤ºï¼šè¦è·å¾—ä½ çš„æ¸²æŸ“å…ƒç´ çš„æ ¹å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ `container.firstChild`ã€‚

> ğŸš¨ å¦‚æœä½ å‘ç°è‡ªå·±ä½¿ç”¨ `container` æ¥æŸ¥è¯¢æ¸²æŸ“çš„å…ƒç´ ï¼Œé‚£ä¹ˆä½ åº”è¯¥é‡æ–°è€ƒè™‘ä¸€ä¸‹! 
> å…¶å®ƒçš„æŸ¥è¯¢è¢«è®¾è®¡æˆå¯¹ä½ æ­£åœ¨æµ‹è¯•çš„ç»„ä»¶çš„å˜åŒ–æœ‰æ›´å¼ºçš„é€‚åº”æ€§ã€‚é¿å…ä½¿ç”¨å®¹å™¨æ¥æŸ¥è¯¢å…ƒç´ !

#### `baseElement`

åŒ…å«çš„DOMèŠ‚ç‚¹ï¼Œä½ çš„Vueç»„ä»¶åœ¨ `container` ä¸­è¢«æ¸²æŸ“ã€‚å¦‚æœä½ æ²¡æœ‰åœ¨ `render` çš„é€‰é¡¹ä¸­æŒ‡å®š `baseElement` ï¼Œå®ƒå°†é»˜è®¤ä¸º `document.body`ã€‚

å½“ä½ æƒ³æµ‹è¯•çš„ç»„ä»¶åœ¨å®¹å™¨ `div` ä¹‹å¤–æ¸²æŸ“æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚ï¼Œå½“ä½ æƒ³å¿«ç…§æµ‹è¯•ä½ çš„é—¨æˆ·ç»„ä»¶æ—¶ï¼Œå®ƒç›´æ¥åœ¨bodyä¸­æ¸²æŸ“å…¶HTMLã€‚

> æ³¨æ„ï¼šç”± `render` è¿”å›çš„æŸ¥è¯¢æ˜¯é’ˆå¯¹ `baseElement` çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨æŸ¥è¯¢æ¥æµ‹è¯•ä½ çš„é—¨æˆ·ç»„ä»¶ï¼Œè€Œä¸éœ€è¦ `baseElement`ã€‚

#### `debug(element)`

è¿™ä¸ªæ–¹æ³•æ˜¯ `console.log(prettyDOM(element))` çš„ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚

```jsx
import {render} from '@testing-library/vue'

const HelloWorldComponent = {
  template: `<h1>Hello World</h1>`,
}

const {debug} = render(HelloWorldComponent)
debug()
// <div>
//   <h1>Hello World</h1>
// </div>
```

è¿™æ˜¯å¯¹ `prettyDOM` çš„ä¸€ä¸ªç®€å•åŒ…è£…ï¼Œå®ƒä¹Ÿæ˜¯å…¬å¼€çš„ï¼Œæ¥è‡ª
[`DOM Testing Library`](dom-testing-library/api-debugging.mdx/#prettydom)ã€‚

#### `unmount()`

`@vue/test-utils`
[destroy](https://vue-test-utils.vuejs.org/api/wrapper/#destroy) çš„åˆ«å.

#### `html()`

`@vue/test-utils`
[html](https://vue-test-utils.vuejs.org/api/wrapper/#html) çš„åˆ«å.

#### `emitted()`

`@vue/test-utils`
[emitted](https://vue-test-utils.vuejs.org/api/wrapper/#emitted) çš„åˆ«å.

#### `rerender(props)`

`@vue/test-utils`
[setProps](https://test-utils.vuejs.org/api/#setprops) çš„åˆ«å.

å®ƒé€šè¿‡è¿”å›ä¸€ä¸ª Promiseï¼Œæ‰€ä»¥ä½ å¯ä»¥ `await rerender(...)`ã€‚

---

## `fireEvent`

å› ä¸ºVueåœ¨é‡æ¸²æŸ“æ—¶å¼‚æ­¥åº”ç”¨DOMæ›´æ–°ï¼Œæ‰€ä»¥ `fireEvent` å·¥å…·è¢«é‡æ–°å¯¼å‡ºä¸º `async` å‡½æ•°ã€‚
ä¸ºäº†ç¡®ä¿DOMåœ¨å“åº”æµ‹è¯•ä¸­çš„äº‹ä»¶æ—¶è¢«æ­£ç¡®æ›´æ–°ï¼Œå»ºè®®æ€»æ˜¯ `await ` `fireEvent`ã€‚

```js
await fireEvent.click(getByText('Click me'))
```

æ­¤å¤–ï¼ŒVueæµ‹è¯•åº“æš´éœ²äº†ä¸¤ä¸ªæœ‰ç”¨çš„æ–¹æ³•:

### `touch(elem)`

å®ƒåŒæ—¶è§¦å‘äº† `focus()` å’Œ `blur()` äº‹ä»¶ã€‚

```js
await fireEvent.touch(getByLabelText('username'))

// Same as:
await fireEvent.focus(getByLabelText('username'))
await fireEvent.blur(getByLabelText('username'))
```

### `update(elem, value)`

æ­£ç¡®å¤„ç†ç”± `v-model` æ§åˆ¶çš„è¾“å…¥ã€‚å®ƒæ›´æ–°input/select/textareaçš„å†…éƒ¨å€¼ï¼ŒåŒæ—¶å‘å‡ºé€‚å½“çš„æœ¬åœ°äº‹ä»¶ã€‚

è¯·çœ‹
[v-modelç¤ºä¾‹æµ‹è¯•](vue-testing-library/examples.mdx#example-using-v-model)
ä¸­çš„ä¸€ä¸ª `update` è¿è¡Œå®ä¾‹ã€‚

---

## `cleanup`

è§£é™¤ç”¨ [render](#rendercomponent-options-callback) æŒ‚è½½çš„Vueæ ‘ã€‚

> å¦‚æœä½ ä½¿ç”¨çš„æ˜¯æ”¯æŒ `afterEach` hook çš„ç¯å¢ƒï¼ˆå¦‚Jestï¼‰ï¼Œå°±æ²¡æœ‰å¿…è¦æ‰‹åŠ¨è°ƒç”¨æ¸…ç†ã€‚Vue Testing Libraryä¼šå¸®ä½ å¤„ç†ã€‚

å¦‚æœåœ¨è°ƒç”¨renderæ—¶æ²¡æœ‰è°ƒç”¨ `cleanup`ï¼Œå¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼å’Œæµ‹è¯•ä¸å¹‚ç­‰ï¼ˆè¿™å¯èƒ½ä¼šå¯¼è‡´æµ‹è¯•ä¸­éš¾ä»¥è°ƒè¯•çš„é”™è¯¯ï¼‰ã€‚
