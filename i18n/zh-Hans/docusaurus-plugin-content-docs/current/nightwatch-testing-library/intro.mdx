---
id: intro
title: Nightwatch Testing Library
---

[`nightwatch-testing-library`][gh] å…è®¸åœ¨ [Nightwatch](https://nightwatchjs.org) ä¸­ä½¿ç”¨ dom-testing-library æŸ¥è¯¢æ¥è¿›è¡Œç«¯åˆ°ç«¯çš„webæµ‹è¯•ã€‚

## å®‰è£…

> è¯·åŠ¡å¿…å…ˆæŒ‰ç…§ [Nightwatchçš„å®‰è£…å’Œé…ç½®è¯´æ˜](https://nightwatchjs.org/gettingstarted/installation/) è¿›è¡Œæ“ä½œã€‚

ç„¶åå°±

```bash npm2yarn
npm install -D @testing-library/nightwatch
```

- [nightwatch-testing-library on GitHub][gh]

## å…ˆçœ‹è¿™ä¸ª

åœ¨å®ƒçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œ`nightwatch-testing-library`åœ¨dom-testing-libraryæŸ¥è¯¢å’Œcssé€‰æ‹©å™¨ä¹‹é—´è¿›è¡Œè½¬æ¢ã€‚
è¿™æ˜¯ç”±äºNightwatchéµå®ˆäº†WebDriverçš„[å®šä½å™¨ç­–ç•¥](https://www.w3.org/TR/webdriver/#locator-strategies)æ ‡å‡†ã€‚
ç›®å‰ï¼Œè¿™æ„å‘³ç€æ—¥å¿—ä¸­ä¼šæœ‰ä¸€äº›éå¸¸è¯¦ç»†çš„cssè·¯å¾„ã€‚æ¬¢è¿ä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ğŸ¤— [å®šåˆ¶æŠ¥å‘Š](https://nightwatchjs.org/guide/extending-nightwatch/#custom-reporter) çš„PRã€‚

**æ‰€ä»¥è¯·è®°ä½ï¼ŒNWTLæŸ¥è¯¢çš„ç»“æœæ˜¯WebDriverå®šä½å™¨ï¼Œè€Œä¸æ˜¯DOMèŠ‚ç‚¹ã€‚**

> æ³¨æ„ï¼Œåœ¨NWTLä¸­ï¼Œæ‰€æœ‰çš„æŸ¥è¯¢å¿…é¡»æ˜¯ `await`ã€‚

## ä½¿ç”¨

```javascript
const {getQueriesFrom} = require('@testing-library/nightwatch')

module.exports = {
  beforeEach(browser, done) {
    browser.url('http://localhost:13370')
    done()
  },

  async getByLabelText(browser) {
    const {getByLabelText} = getQueriesFrom(browser)

    const input = await getByLabelText('Label Text')
    browser.setValue(input, '@TL FTW')

    browser.expect.element(input).value.to.equal('@TL FTW')
  },

  async getByAltText(browser) {
    const {getByAltText} = getQueriesFrom(browser)
    const image = await getByAltText('Image Alt Text')

    browser.click(image)
    browser.expect
      .element(image)
      .to.have.css('border')
      .which.equals('5px solid rgb(255, 0, 0)')
  },
}
```

### `AllBy` æŸ¥è¯¢

`AllBy` æŸ¥è¯¢çš„ç»“æœæœ‰ä¸€ä¸ªé¢å¤–çš„åŠŸèƒ½ï¼š`nth`ï¼Œå®ƒå¯ä»¥ç”¨äº nightwatch åŠŸèƒ½ä»¥åŠNWTLçš„ `within` åŠŸèƒ½ã€‚

```javascript

    async 'getAllByText - regex'(browser) {
        const { getAllByText } = getQueriesFrom(browser);
        const chans = await getAllByText(/Jackie Chan/)


        browser.expect.elements(chans).count.to.equal(2)

        const firstChan = chans.nth(0);
        const secondChan = chans.nth(1);


        browser.click(chans.nth(0));
        browser.click(chans.nth(1));

        browser.expect.element(secondChan).text.to.equal('Jackie Kicked');
        browser.expect.element(firstChan).text.to.equal('Jackie Kicked');

    },

```

## é…ç½®

ä½ å¯ä»¥åƒ [dom-testing-library][config] ä¸€æ ·ä½¿ç”¨ `configure` å‡½æ•°è‡ªå®šä¹‰testIdAttributeã€‚

```javascript
const {configure} = require('@testing-library/nightwatch')

configure({testIdAttribute: 'data-automation-id'})
```

## å®¹å™¨

é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ä¼šé¢„å…ˆç»‘å®šåˆ° `document.body`ï¼Œæ‰€ä»¥ä¸éœ€è¦æä¾›ä¸€ä¸ªå®¹å™¨ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æƒ³ç”¨ä¸€ä¸ªå®¹å™¨æ¥é™åˆ¶ä½ çš„æŸ¥è¯¢ï¼Œä½ å¯ä»¥ä½¿ç”¨ `within`ã€‚

### ä½¿ç”¨ `within` çš„ä¾‹å­

```javascript
const {getQueriesFrom, within} = require('@testing-library/nightwatch')

module.exports = {
  beforeEach(browser, done) {
    browser.url('http://localhost:13370')
    done()
  },
  async 'getByText within container'(browser) {
    const {getByTestId} = getQueriesFrom(browser)

    const nested = await getByTestId('nested')
    const button = await within(nested).getByText('Button Text')

    browser.click(button)
    browser.expect.element(button).text.to.equal('Button Clicked')
  },
}
```

[config]: ../dom-testing-library/api-configuration.mdx
[gh]: https://github.com/testing-library/nightwatch-testing-library
